### 程序的链接

根据外部访问符号名表（如变量名、函数名等），将经过编译或汇编 得到的一组**目标模块以及它们所需要的库函数**，装配成一个完整的**装入模块** 。



#### 1.静态链接方式

下图B和C都属于外部调用符号，在将这几个目标模块装配成一个装入模块时，须解决以下两个问题：

(1) 对相对地址进行修改。

(2) 变换外部调用符号。

![img](https://img2020.cnblogs.com/blog/1986811/202004/1986811-20200428221435737-1081544556.png)

这种先进行链接所形成的一个完整的装入模块，又称为可执行文件。通常都不再拆开它，要运行时可直接将它装入内存。**这种事先进行链接，以后不再拆开的链接方式，称为静态链接方式。**



#### 2.装入时动态链接（所有的模块都装入内存 ）

用户源程序经编译后所得的目标模块，是在装入内存时边装入边链接的， 然后再按照上图所示的方式来修改目标模块中的相对地址。

优点：

1. 便于修改和更新。对于经静态链接装配在一起的装入模块，如果要修改或更新其中的某个目标模块，则要求重新打开装入模块。这不仅是低效的，而且有时是不可能的。若采用动态链接方式，由于各目标模块是分开存放的，所以要修改或更新各目标模块是件非常容易的事。
2. 便于实现对目标模块的共享。在采用静态链接方式时，每个应用模块都必须含有其目标模块的拷贝，无法实现对目标模块的共享。但采用装入时动态链接方式，OS则很容易将一个目标模块链接到几个应用模块上，实现多个应用程序对该模块的共享。



#### 3.运行时动态链接（需要某个模块时才装入内存）

> 在许多情况下，应用程序在运行时，每次要运行的模块可能是不相同的。但由于事先无法知道本次要运行哪些模块，故只能是将所有可能要运行到的模块都全部装入内存，并在装入时全部链接在一起。显然这是低效的，因为往往会有些目标模块根本就不运行。比较典型的例子是作为错误处理用的目标模块，如果程序在整个运行过程中都不出现错误，则显然就不会用到该模块。

在执行过程中，当发现一个被调用模块尚未装入内存时，立即由OS去找到该模块并将之装入内存，把它链接到调用者模块上。凡在执行过程中未被用到的目标模块，都不会被调入内存和被链接到装入模块上，这样不仅可加快程序的装入过程，而且可节省大量的内存空间。